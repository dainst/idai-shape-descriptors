/* eslint-disable @typescript-eslint/no-explicit-any */
import * as tf from '@tensorflow/tfjs';
import { setDescriptorStartPointInvariant } from
    '../../../src/shape_descriptors/fourier_descriptors/fourier_descriptors_phase';

describe('Test setDescriptorStartPointInvariant', () => {
    const inArray = Array(81).fill(0).map((x, y) => x + y);
    const descriptor = tf.complex(inArray, inArray);
    const decimals = 3;

    it('Should return correct start point shifted descriptors G_a and G_b', () => {
        const [G_a, G_b] = setDescriptorStartPointInvariant(descriptor);

        const roundedG_a = Array.from(G_a.dataSync()).map((value: any) => value.toFixed(decimals));
        const roundedG_b = Array.from(G_b.dataSync()).map((value: any) => value.toFixed(decimals));

        expect(roundedG_a).toEqual(expectedG_a.map(val => val.toFixed(decimals)));
        expect(roundedG_b).toEqual(expectedG_b.map(val => val.toFixed(decimals)));
    });

});


const expectedG_a = [
    0.0,
    0.0,
    0.9761626653843904,
    1.0232821950516107,
    1.9035668485046546,
    2.0919926513432254,
    2.78062743145531,
    3.20438934704231,
    3.6058146051382627,
    4.358681111686377,
    4.377655297485443,
    5.553029272063819,
    5.094734554673849,
    6.7855493379248415,
    5.755696874253427,
    8.054312726217509,
    6.359247489143713,
    9.357348522515306,
    6.904153601491366,
    10.692645278274867,
    7.389245565417712,
    12.05815284253582,
    7.813418017723017,
    13.451784226648943,
    8.175630955652567,
    14.871417500594069,
    8.474910760868571,
    16.31489771942546,
    8.710351168811542,
    17.780038878359726,
    8.881114182674867,
    19.264625894999657,
    8.986430931257177,
    20.76641661716687,
    9.025602469998248,
    22.283143854796645,
    8.99800052454606,
    23.812517434329976,
    8.903068176244805,
    25.352226274020534,
    8.740320488976423,
    26.899940478558293,
    8.509345076831286,
    28.453313451396255,
    8.209802612127243,
    30.009984023153173,
    7.8414272733400505,
    31.56757859445223,
    7.4040271325524465,
    33.12371329154428,
    6.897484482073576,
    34.67599613305369,
    6.321756099925365,
    36.22202920617585,
    5.67687345393724,
    37.75941085064732,
    4.962942844235993,
    39.28573784880267,
    4.18014548396285,
    40.79860762002676,
    3.3287375180954193,
    42.295620417906434,
    2.409049980297695,
    43.774381528382875,
    1.421488687767134,
    45.2325034672032,
    0.36653407409354344,
    46.66760817497002,
    -0.7552590398097259,
    48.07732920808711,
    -1.9432617365960319,
    49.45931392390196,
    -3.196771355045069,
    50.81122565834801,
    -4.515011904094436,
    52.13074589439408,
    -5.897134538099728,
    53.41557641961333,
    -7.3422180930349015,
    54.66344147119088,
    -8.84926968329897,
    55.872089866696825,
    57.268892113364245,
    -9.070501425381451,
    58.86832158435941,
    -7.907004100191429,
    60.44394173798351,
    -6.67307329311285,
    61.99331944198215,
    -5.369203345409598,
    63.51403207293501,
    -3.9959641938063406,
    65.00366972855686,
    -2.5540011395262106,
    66.45983743470865,
    -1.0440345550310894,
    67.88015734541094,
    0.5331404714087853,
    69.26227093415491,
    2.176654553143422,
    70.6038411748111,
    3.8855644843511286,
    71.90255471044094,
    5.6588537807622075,
    73.15612400832383,
    7.495433281588561,
    74.36228949951933,
    9.394141812303843,
    75.51882170129464,
    11.35374690787448,
    76.62352332075662,
    13.372945595995965,
    77.67423133804026,
    15.450365239844814,
    78.66881906741767,
    17.584564439812063,
    79.60519819470562,
    19.774033993640128,
    80.48132078936533,
    22.01719791434125,
    81.29518128970359,
    24.312414505232244,
    82.0448184596028,
    26.65797749137809,
    82.7283173152249,
    29.05211720669357,
    83.3438110201549,
    31.4930018359112,
    83.88948274746973,
    33.97873871058164,
    84.36356750724042,
    36.507375658232284,
    84.7643539379985,
    39.07690240376942,
    85.09018606072155,
    41.68525202216952,
    85.33946499391779,
    44.33030244146637,
    85.51065062841587,
    47.00987799500225,
    85.60226326049327,
    49.72175102187374,
    85.61288518200432,
    52.463643514465744,
    85.54116222619894,
    55.23322881193093,
    85.38580526795216,
    58.028133338436376,
    85.14559167715652,
    60.845938384964796,
    84.81936672406052,
    63.68418193342312,
    84.40604493537005,
    66.54036052177874,
    83.90461139996276,
    69.41193114891155,
    83.31412302310007,
    72.29631321783806,
    82.6337097280574,
    75.19089051593386,
    81.86257560412885,
    78.09301323075123,
];
const expectedG_b = [
    0.0,
    0.0,
    -0.9761626653843907,
    -1.0232821950516104,
    1.9035668485046557,
    2.0919926513432245,
    -2.7806274314553114,
    -3.2043893470423095,
    3.605814605138267,
    4.358681111686374,
    -4.377655297485453,
    -5.553029272063813,
    5.094734554673854,
    6.785549337924838,
    -5.755696874253452,
    -8.054312726217491,
    6.359247489143732,
    9.357348522515293,
    -6.904153601491376,
    -10.69264527827486,
    7.389245565417754,
    12.058152842535796,
    -7.813418017723049,
    -13.451784226648925,
    8.175630955652586,
    14.871417500594056,
    -8.474910760868577,
    -16.31489771942546,
    8.710351168811652,
    17.780038878359672,
    -8.881114182674967,
    -19.26462589499961,
    8.98643093125726,
    20.766416617166833,
    -9.025602469998312,
    -22.28314385479662,
    8.998000524546105,
    23.812517434329955,
    -8.903068176245005,
    -25.35222627402046,
    8.740320488976609,
    26.899940478558236,
    -8.509345076831247,
    -28.45331345139627,
    8.209802612127387,
    30.009984023153134,
    -7.84142727334039,
    -31.567578594452147,
    7.404027132552528,
    33.12371329154426,
    -6.8974844820738745,
    -34.67599613305363,
    6.321756099925384,
    36.22202920617585,
    -5.676873453937489,
    -37.759410850647285,
    4.96294284423648,
    39.28573784880261,
    -4.180145483963024,
    -40.798607620026736,
    3.3287375180958563,
    42.295620417906406,
    -2.4090499802977945,
    -43.77438152838287,
    1.4214886877675,
    45.232503467203195,
    -0.3665340740942007,
    -46.66760817497001,
    -0.7552590398094416,
    48.07732920808711,
    1.9432617365954314,
    -49.45931392390198,
    -3.1967713550448735,
    50.81122565834802,
    4.5150119040939245,
    -52.13074589439413,
    -5.897134538098879,
    53.415576419613416,
    7.342218093034482,
    -54.663441471190936,
    -8.849269683298196,
    55.872089866696946,
    57.26889211336437,
    -9.070501425380655,
    -58.86832158435947,
    7.907004100190981,
    60.44394173798361,
    -6.673073293111887,
    -61.99331944198221,
    5.369203345408991,
    63.51403207293503,
    -3.9959641938060955,
    -65.00366972855689,
    2.5540011395254254,
    66.45983743470865,
    -1.0440345550306986,
    -67.88015734541094,
    -0.5331404714097445,
    69.26227093415488,
    2.176654553143983,
    -70.60384117481108,
    -3.8855644843512778,
    71.90255471044088,
    5.658853780762961,
    -73.15612400832381,
    -7.495433281588866,
    74.36228949951922,
    9.394141812304774,
    -75.51882170129457,
    -11.353746907874978,
    76.6235233207566,
    13.372945595996,
    -77.67423133804013,
    -15.450365239845475,
    78.66881906741763,
    17.584564439812258,
    -79.60519819470542,
    -19.774033993640987,
    80.48132078936523,
    22.017197914341626,
    -81.29518128970362,
    -24.31241450523213,
    82.04481845960261,
    26.657977491378656,
    -82.72831731522467,
    -29.052117206694227,
    83.34381102015485,
    31.49300183591136,
    -83.88948274746963,
    -33.97873871058188,
    84.36356750724026,
    36.50737565823262,
    -84.7643539379983,
    -39.07690240376985,
    85.0901860607213,
    41.685252022170054,
    -85.33946499391779,
    -44.3303024414664,
    85.51065062841582,
    47.00987799500236,
    -85.60226326049315,
    -49.72175102187395,
    85.61288518200415,
    52.46364351446606,
    -85.54116222619888,
    -55.233228811931006,
    85.38580526795205,
    58.02813333843655,
    -85.14559167715633,
    -60.845938384965066,
    84.81936672406047,
    63.68418193342316,
    -84.40604493536995,
    -66.5403605217789,
    83.90461139996269,
    69.41193114891165,
    -83.31412302310005,
    -72.2963132178381,
    82.63370972805735,
    75.1908905159339,
    -81.86257560412884,
    -78.09301323075124,

];